<% objects.each do |obj| %>
<table class="table table-sm table-light lists">
  <% if obj.isbn.present? %>
    <% book = RakutenWebService::Books::Book.search(isbn: obj.isbn).first%>
    <tr>　<!--1行目 isbnを所持している場合のみ本情報表示-->
      <% unless current_page?(book_path(book.isbn)) %>
        <td colspan="1", style="padding: 20px" rowspan="2">
          <%= link_to book_path(book.isbn) do %>
            <%= image_tag(book['small_image_url']) %>
          <% end %>
        </td>
        <td colspan="4">
          <%= link_to book_path(book.isbn) do %>
            <%= book['title'].truncate(30) %>
          <% end %>
        </td>
      <% end %>

  <% end %>
  
  　<!--2行目 ユーザー名と投稿日表示-->
    <% if obj.is_a?(Review) %>
      <td colspan="3">
        <%= link_to mypage_path(name: obj.user.name) do %>
          <%= obj.user.name %>
        <% end %>
        さんのレビュー
      </td>
    <% elsif obj.is_a?(Tweet) %>
      <td colspan="3">
        <%= link_to mypage_path(name: obj.user.name) do %>
          <%= obj.user.name %>
        <% end %>
        さんのつぶやき
      </td>
    <% end %>
    <td colspan="2"><%= obj.created_at.strftime('%Y/%m/%d') %></td>
  </tr>
  
  <tr>　<!--3行目 投稿文表示-->
    <td colspan="9">
      <% if obj.is_a?(Review) %>
        <% if obj.spoiler == false %>
          <%= render_review_with_hashtags(obj.content, 130) %>
          <%= link_to "（続きを見る）", review_path(obj.id), style: "color: #ff7f50" %>
        <% else %>
          <%= link_to review_path(obj.id) do %>
            <p class="spoiler">ネタバレを含みます（クリックして読む）</p>
          <% end %>
        <% end %>
        
      <% elsif obj.is_a?(Tweet) %>
        <%= render_tweet_with_hashtags(obj.tweet_content, 50) %>
        <%= link_to "（続きを見る）", tweet_path(obj.id), style: "color: #ff7f50" %>
      <% end %>
    </td>
  </tr>
  
  <tr>　<!--4行目　いいねとコメント（自分の投稿はステータスと削除・編集リンク表示）-->
    <% if obj.isbn.nil? %>
      <td colspan="1"></td>
    <% end %>
    <% if user_signed_in? && obj.is_a?(Review) %>
      <td colspan="1" class=<%= "like-" + obj.id.to_s %> >
        <%= render "public/likes/reviewbtn", review: obj %>
      </td>
    <% elsif user_signed_in? && obj.is_a?(Tweet) %>
      <td  colspan="1" class=<%= "like-" + obj.id.to_s %> >
        <%= render "public/likes/tweetbtn", tweet: obj %>
      </td>
    <% else %>
      <td colspan="1"><i class="fas fa-heart" aria-hidden="true" style="color: red;"></i><%= obj.likes.count %>いいね</td>
    <% end %>
    
    <td colspan="1">　<!--コメント-->
      <% if obj.is_a?(Review) && obj.review_comments.present? %>
        <%= obj.review_comments.count %>コメント
      <% elsif obj.is_a?(Tweet) && obj.tweet_comments.present? %>
        <% obj.tweet_comments.count %>コメント
      <% else %>
        0コメント
      <% end %>
    </td>
    
    <% if obj.user == current_user && obj.is_a?(Review) %>
      <th colspan="1">ステータス</th>
      <td colspan="1">
        <% if obj.in_release == true %>
          <p class="text-success">公開中</p>
        <% else %>
          <p class="text-secondary">下書き</p>
        <% end %>
      </td>
    <% else %>
      <td colspan="2"></td>
    <% end %>
    
    <% if obj.is_a?(Review) && obj.user == current_user %>
      <td colspan="2">
        <%= link_to "編集する", edit_review_path(obj.id), style: "display: inline", class:"btn btn-success btn-sm"%>
        <%= link_to "削除する", review_path(obj.id), method: :delete, "data-confirm" => "レビューを削除しますか？", style: "display: inline", class: "btn btn-danger btn-sm" %>
      </td>
    <% elsif obj.is_a?(Tweet) && obj.user == current_user %>
      <td colspan="2">
        <%= link_to "削除する", tweet_path(obj.id), method: :delete, "data-confirm" => "つぶやきを削除しますか？", style:"display: inline-block", class:"btn btn-danger btn-sm" %>
      </td>
    <% else %>
      <td colspan="2"></td>
    <% end %>
    </td>
  </tr>
</table>
<% end %>