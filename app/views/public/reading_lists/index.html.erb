<!--reading_listsの一覧-->
<div class="container-fluid">
  <div class="row">
    <% if params[:user_name] %>
      <div class="col-md-3">
        <%= render 'public/partial/userinfo', user: @user, book: @book, recommenbook: @recommenbook, in_release_reviews: @in_release_reviews %>
       </div>
    <% end %>
    
    <div class="col-md-8 offset-md-1">
      <h4 class="page-title">
        <% if params[:user_name].present? && params[:user_name] == current_user.name %>
          あなたの読んだ本一覧
        <% elsif params[:user_name].present? && params[:user_name] != current_user.name %>
          <%= @user.name %>さんの読んだ本一覧
        <% elsif params[:user_name].blank? && params[:book_id].present? %>
          <%= @book['title'].truncate(20) %>の読んだ本一覧
        <% else %>
          読んだ本一覧
        <% end %>
      </h4>
      
      <% if @readed_books.present? %>
        <table class="table table-sm">
          <thead>
            <tr>
              <th style="width:10%"></th>
              <th style="width:20%">タイトル</th>
              <th style="width:10%">著者</th>
              <th style="width:30%">本の概要</th>
              <th style="width:20%">読み終わった日</th>
            </tr>
          </thead>
          <% @readed_books.each do |readed_book| %>
            <% isbn = readed_book.isbn %>
            <% book = RakutenWebService::Books::Book.search(isbn: isbn, outOfStockFlag: 1).first %>
            <tbody>
              <tr>
                <td class="text-center">
                  <%= link_to book_path(book.isbn) do %>
                    <%= image_tag(book['small_image_url']) %>
                  <% end %>
                </td>
                <td>
                  <%= link_to book_path(book.isbn) do %>
                    <%= book['title'] %>
                  <% end %>
                </td>
                <td><%= book['author'] %></td>
                <td><%= book['item_caption'] %></td>
                <td><%= readed_book.readed_at&.strftime("%Y/%m/%d") %></td>
              </tr>
            </tbody>
          <% end %> <!--readed_books.each end-->
        </table>
      <% else %> <!--if @readed_books.nil-->
        <p>読んだ本がありません</p>
      <% end %> <!--if readed_books.present? end-->
    </div> <!--col-md-8 end-->
  </div> <!--row end-->
</div> <!--container-fluid end-->